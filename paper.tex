\documentclass[runningheads]{llncs}



\usepackage{enumitem}


\usepackage{color}

\usepackage{graphicx}
\usepackage{tikz}
\usepackage{calc}
\usepackage{array}

\usepackage{amsmath, amssymb}
\DeclareMathOperator*{\argmin}{arg\,min}

\usepackage{graphbox}
\usepackage{wasysym}

\usetikzlibrary{automata,arrows}

\usepackage{comment}

\usepackage{wrapfig}


\title{On the power of oritatami cotranscriptional folding with unary bead sequence\thanks{This work is supported in part by KAKENHI Grant-in-Aid for Challenging Research (Exploratory) No.~18K19779 granted to S.~Z.~F. and S.~S. and JST Program to Disseminate Tenure Tracking System No.~6F36 granted to S.~S.}
}
\titlerunning{Power of unary oritatami cotranscriptional folding}
\author{
Szil\'{a}rd Zsolt Fazekas\inst{1} \and 
Kohei Maruyama\thanks{Primary corresponding author (\email{k.maruyama@uec.ac.jp})} \and
Reoto Morita \and \\
Shinnosuke Seki\inst{2}\thanks{Secondary corresponding author (\email{s.seki@uec.ac.jp})}
}
\institute{
Akita University, 
Graduate School of Engineering Science, 
1-1 Tegate Gakuen-machi, Akita, 0108502, Japan \\
%\email{szilard.fazekas@ie.akita-u.ac.jp}
\and
The University of Electro-Communications, 
Graduate School of Informatics and Engineering, 
1-5-1 Chofugaoka, Chofu, Tokyo, 1828585, Japan \\
}

\begin{document}

\maketitle

\begin{abstract}
We investigate simple oritatami systems in an attempt to establish lower bounds on the size and complexity of computationally universal systems. 
In particular, we look at oritatami systems, where the folding sequence consists of a number of beads of the same type and show that under reasonable assumptions, these systems are not universal.
\end{abstract}

%------------------------------------------------------
	\section{Introduction}
%------------------------------------------------------

\begin{figure}[htb]
\centering
\begin{minipage}{0.6\linewidth}
\includegraphics[width=\linewidth]{Fig/rna_origami.pdf}
\end{minipage}
\begin{minipage}{0.05\linewidth}
\centering
{\Large $\Rightarrow$}
\end{minipage}
\begin{minipage}{0.3\linewidth}
\scalebox{0.3}{\begin{tikzpicture}
\tikzstyle{mol} = [fill,circle,inner sep=2pt]

\draw[-triangle 90, very thick] (3, 0) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(60:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(60:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(60:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(60:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(60:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(240:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(240:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(240:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(240:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(60:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(60:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(60:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(60:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(240:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(240:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(240:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(240:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(0:1) node[mol] {}
-- ++(240:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1) node[mol] {}
-- ++(180:1)
;

\draw[dashed, very thick]
(-5, 0) -- ++(120:1)
(-4, 0) -- ++(120:1)
(-3, 0) -- ++(120:3)
(-2, 0) -- ++(120:3)
(-1, 0) -- ++(120:5)
(0, 0) -- ++(120:1) ++(120:1) -- ++(120:3)
(1, 0) -- ++(120:1) ++(120:1) -- ++(120:3)
(2, 0) -- ++(120:1) ++(120:1) -- ++(120:1) ++(120:1) -- ++(120:1)
(3, 0) -- ++(120:1) ++(120:3) -- ++(120:1)
(4, 0) -- ++(120:1) ++(120:1) -- ++(120:1) ++(120:1) -- ++(120:1)
(5, 0) -- ++(120:3)
(6, 0) -- ++(120:3) ++(120:1) -- ++(120:1)
(7, 0) -- ++(120:5)
(8, 0) ++(120:2) -- ++(120:3)
(9, 0) ++(120:2) -- ++(120:3)
(10, 0) ++(120:4) -- ++(120:1)
(11, 0) ++(120:4) -- ++(120:1)
(3, 0) -- ++(0:1)
;

\foreach \y in {3, 5} {
\draw[dashed,very thick] (0, 0)++(60:\y) -- ++(300:1);	
}

\end{tikzpicture}}

\end{minipage}
\caption{
(Left) RNA origami. 
(Right) an abstraction of its product, i.e., an RNA tile, as a configuration of an oritatami system. A dot $\bullet$ in the figure on the right represents a sequence of 3-4 nucleotides, and the solid arrow and dashed lines represent its RNA transcript and interactions (respectively) based on hydrogen bonds between nucleotides.
}
\label{fig:rna_origami}
\end{figure}

Transcription is the first essential step of gene expression, in which a DNA template sequence is copied into a single stranded RNA sequence by a `molecular Xerox' called RNA polymerase, letter by letter according to the complimentarity relation ${\tt A} \rightarrow {\tt U}$, ${\tt G} \rightarrow {\tt C}$, ${\tt C} \rightarrow {\tt G}$, and ${\tt T} \rightarrow {\tt A}$. 
The copied RNA sequence is called \textit{transcript}. 
The transcript starts folding upon itself into intricate structures immediately after it emerges from the polymerase, as illustrated in Fig.~\ref{fig:rna_origami} (Left). 



In a recent breakthrough in molecular engineering by Geary, Rothemund and Andersen~\cite{GearyRothemundAndersen2014} the co-transcriptional folding of RNA is controlled by careful design of the DNA template. As demonstrated in laboratory, this method, called RNA Origami, makes it possible to cotranscriptionally self-assemble a unique RNA rectangular tile highly probably (see Fig.~\ref{fig:rna_origami} (Left)). 
Geary et al.~\cite{GeMeScSe2016} proposed a mathematical model for this process, called oritatami system. 
In this model, an RNA structure is abstracted as a directed path with information on hydrogen-based interaction (bonds) over the triangular grid graph $\mathbb{T}$ as illustrated in Fig.~\ref{fig:rna_origami}. 
An oritatami system folds a transcript of abstract molecules (beads) of finite number of types over $\mathbb{T}$. 
This model has been just proved efficiently Turing universal in \cite{GeMeScSe2018} by simulating cyclic tag systems introduced by Cook~\cite{Cook2004}. 
The simulation involves a very large and complex oritatami system. 
This system is deterministic in the sense that every bead is stabilized uniquely point-wise as well as interaction-wise (for the formal definition, see Sect.~\ref{sec:preliminaries}). 
One future direction of research is to quest for a smaller Turing-universal oritatami system.




Closely related is the question of where not to look for universal systems, i.e., what are the limitations of simple oritatami system. 
In search for simple oritatami systems, there are a number of restrictions one can pose on them:
\begin{itemize}
\item bounds on the relative speed of transcription to folding (delay), the number of bead types, or the number of hydrogen bonds per bead (arity);
\item bounds on the length of the transcript or on the complexity of rules to decide what types of beads interact with each other (attraction rules);
\item structural conditions on the transcript or the attraction rules.
\end{itemize}
%
In \cite{DHOPRSST2018}, Demaine et al. proved that at delay 1 and arity 1, upon an initial structure of $n$ beads, a deterministic oritatami system cannot fold into any conformation of more than $10n$ beads, no matter how many bead types are available. 
We consider this finiteness problem for unary oritatami systems under various settings of the values of delay and arity, which is formalized as follows. 

\begin{problem}\label{prob:det_unary_length}
Give an upper bound on the length of a transcript of a delay-$\delta$, arity-$\alpha$ deterministic unary oritatami system whose seed is of length $n$ by a function in $\delta$, $\alpha$, and $n$. 
\end{problem}

\begin{figure}[tb]
  \begin{center}
    \begin{tikzpicture}
      \fill (0,0) circle[radius = 0.1];
      \fill (1.5,0) circle[radius = 0.1];
      \fill (3,0) circle[radius = 0.1];
      \fill (4.5,0) circle[radius = 0.1];
      \fill (6,0) circle[radius = 0.1];

      \draw[dashed] (0,0)--(1.5,0);
      \draw[dashed] (1.5,0)--(3,0);
      \draw[dashed] (3,0)--(4.5,0);
      \draw[dashed] (4.5,0)--(6,0);
      \draw[->] (0,0)--(60:0.75);
      \draw[->] (1.5,0)--++(60:0.75);
      \draw[->] (3,0)--++(60:0.75);
      \draw[->] (4.5,0)--++(60:0.75);
      \draw (0,0)--(60:1.5);
      \draw (1.5,0)--++(60:1.5);
      \draw (3,0)--++(60:1.5);
      \draw (4.5,0)--++(60:1.5);
      
      \begin{scope}[shift=(60:1.5)]
        \fill (0,0) circle[radius = 0.1];
        \fill (1.5,0) circle[radius = 0.1];
        \fill (3,0) circle[radius = 0.1];
        \fill (4.5,0) circle[radius = 0.1];
        \draw[dashed] (0,0)--(1.5,0);
        \draw[dashed] (1.5,0)--(3,0);
        \draw[dashed] (3,0)--(4.5,0);
        \draw[->] (0,0)--(-60:0.75);
        \draw[->] (1.5,0)--++(-60:0.75);
        \draw[->] (3,0)--++(-60:0.75);
        \draw[->] (4.5,0)--++(-60:0.75);
        
        \draw (0,0)--(-60:1.5);
        \draw (1.5,0)--++(-60:1.5);
        \draw (3,0)--++(-60:1.5);
        \draw (4.5,0)--++(-60:1.5);
      \end{scope}
      
    \end{tikzpicture}
    \caption{The zig-zag conformation. This is the only one infinite conformation foldable deterministically by an unary oritatami ssytem at delay 1 and arity 2.}
    \label{TTT_zigzag}
  \end{center}
\end{figure}

\begin{figure}[tb]
\centering
\begin{tikzpicture}

\node (origin) at (0, 0) {};

\draw[-latex] (origin) -- ++(0:10) node[below] {$\delta$}; 
\node at (2, -0.2) {1};
\node at (4, -0.2) {2 and 3};
\node at (6, -0.2) {4 and larger}; 
\draw[-latex] (origin) -- ++(90:5) node[left] {$\alpha$}; 
\node at (-0.2, 1) {1};
\node at (-0.2, 2) {2};
\node at (-0.2, 3) {3};
\node at (-0.2, 4) {4};

%Results
\node at (2, 4) {$3n(n{+}1){+}1$};
\node at (2, 3) {$4n{+}14$};
\node at (2, 2.2) {$\infty$ but zigzag after};
\node at (2, 1.8) {$(27n^2{+}9n{+}1)$-th bead};
\node at (2, 1) {$10n$ \cite{DHOPRSST2018}};

\node at (4, 1) {$3n^2{+}4n{+}1$};

\end{tikzpicture}
\caption{Upper bounds on the length of a conformation foldable by a deterministic unary oritatami system at delay $\delta$ and arity $\alpha$.
At any combination of delay and arity without anything written, no upper bound is known yet.
}
\label{fig:summary}
\end{figure}
In this paper, we will solve this problem partially at arity 1 in Sect.~\ref{sect:arity1} and completely at delay 1 in Sect.~\ref{sect:delay1}. 
Concretely speaking, we will prove that at arity 1 and delay 2 or 3, the upper bound is $(3n+1)(n+1)$. 
Upper bounds for longer delays remain open. 
At delay 1, we will provide a quadratic upper bound $3n(n+1)+1$ for the case of arity being 4, while a linear upper bound $4n+14$ for arity 3. 
At the delay 1 and arity 2, one infinite structure turns out to be foldable deterministically, which is the zigzag conformation shown in Fig.~\ref{TTT_zigzag}. 
These results as well as known upper bounds are summarized in Fig.~\ref{fig:summary}. 
As shown at the end of Sect.~\ref{sec:preliminaries}, the stabilization of first $t$ beads of transcript by a determinisitc oritatami system can be simulated by a deterministic Turing machine within $t^3$ steps (Corollary~\ref{cor:DTIME3}). 
Thus, the above mentioned upper bounds show that at delay 1 and arity 1, 3, or 4, or at delay 2 or 3 and arity 1, the class of deterministic unary oritatami systems is not Turing universal. 
The Turing universal oritatami system by Geary et al. \cite{GeMeScSe2018} employs more than 500 types of beads. 
Thus, this weakness result is not surprising at all. 
The unary oritatami system might not be practical very much, though one bead may abstarct an oligonucleotide (a short sequence of nucleotides), and in that case, unary transcript can be a repetitive but nonunary sequence, which is not so unrealistic in experiments (see \cite{GearyAndersen2014}). 
Nevertheless, this paper makes a first considerable step towards the characterization of non-Turing-universal oritatami systems. 

As a result of independent significance, we show that increasing the delay from 1 to 2 enables an oritatami system to yield a conformation of quadratic length in $n$ as long as 5 types of beads are available. 

%------------------------------------------------------
	\section{Preliminaries}\label{sec:preliminaries}
%------------------------------------------------------

Let $\Sigma$ be a finite set of types of abstract molecules, or \textit{beads}. 
A bead of type $a \in \Sigma$ is called an $a$-bead. 
By $\Sigma^*$ and $\Sigma^\omega$, we denote the set of finite sequences of beads and that of one-way infinite sequences of beads, respectively. 
The empty sequence is denoted by $\lambda$. 
Let $w = b_1 b_2 \cdots b_n \in \Sigma^*$ be a sequence of length $n$ for some integer $n$ and bead types $b_1, \ldots, b_n \in \Sigma$. 
The \textit{length} of $w$ is denoted by $|w|$, that is, $|w| = n$. 
For two indices $i, j$ with $1 \le i \le j \le n$, we let $w[i..j]$ refer to the subsequence $b_i b_{i+1} \cdots b_{j-1}b_j$; if $i = j$, then $w[i..i]$ is simplified as $w[i]$. 
For $k \ge 1$, $w[1..k]$ is called a \textit{prefix} of $w$. 

Oritatami systems fold their transcript, which is a sequence of beads, over the triangular grid graph $\mathbb{T} = (V, E)$ cotranscriptionally. 
We designate one point in $V$ as the origin $O$ of $\mathbb{T}$. 
For a point $p \in V$, let $\hexagon_p^d$ denote the set of points which lie in the regular hexagon of radius $d$ centered at the point $p$. 
Note that $\hexagon_p^d$ consists of $3d(d+1)+1$ points. 
A directed path $P = p_1 p_2 \cdots p_n$ in $\mathbb{T}$ is a sequence of \textit{pairwise-distinct} points $p_1, p_2, \ldots, p_n \in V$ such that $\{p_i, p_{i+1}\} \in E$ for all $1 \le i < n$. 
Its $i$-th point is referred to as $P[i]$. 
Now we are ready to abstract RNA single-stranded structures in the name of conformation. 
A \textit{conformation} $C$ (over $\Sigma$) is a triple $(P, w, H)$ of a directed path $P$ in $\mathbb{T}$, $w \in \Sigma^*$ of the same length as $P$, and a set of h-interactions $H \subseteq \bigl\{\{i, j\} \bigm| 1 \le i, i+2 \le j, \{P[i], P[j]\} \in E \bigr\}$. 
This is to be interpreted as the sequence $w$ being folded along the path $P$ in such a manner that its $i$-th bead $w[i]$ is placed at the $i$-th point $P[i]$ and the $i$-th and $j$-th beads are bound (by a hydrogen-bond-based interaction) if and only if $\{i, j\} \in H$. 
The condition $i+2 \le j$ represents the topological restriction that two consecutive beads along the path cannot be bound. 
The \textit{length} of $C$ is defined to be the length of its transcript $w$ (that is, equal to the length of the path $P$). 
A \textit{rule set} $R \subseteq \Sigma \times \Sigma$ is a symmetric relation over $\Sigma$, that is, for all bead types $a, b \in \Sigma$, $(a, b) \in R$ implies $(b, a) \in R$. 
A bond $\{i, j\} \in H$ is \textit{valid with respect to $R$}, or simply $R$-valid, if $(w[i], w[j]) \in R$. 
This conformation $C$ is \textit{$R$-valid} if all of its bonds are $R$-valid. 
For an integer $\alpha \ge 1$, $C$ is \textit{of arity $\alpha$} if it contains a bead that forms $\alpha$ bonds but none of its bead forms more. 
By $\mathcal{C}_{\le \alpha}(\Sigma)$, we denote the set of all conformations over $\Sigma$ whose arity is at most $\alpha$; its argument $\Sigma$ is omitted whenever $\Sigma$ is clear from the context. 

The oritatami system grows conformations by an operation called elongation. 
Given a rule set $R$ and an $R$-valid conformation $C_1 = (P, w, H)$, we say that another conformation $C_2$ is an elongation of $C_1$ by a bead $b \in \Sigma$, written as $C_1 \xrightarrow{R}_b C_2$, if $C_2 = (P p, wb, H \cup H')$ for some point $p \in V$ not along the path $P$ and set $H' \subseteq \bigl\{ \{i, |w|+1\} \bigm| 1 \le i < |w|, \{P[i], p\} \in E, (w[i], b) \in R \bigr\}$ of bonds formed by the $b$-bead; this set $H'$ can be empty. 
Note that $C_2$ is also $R$-valid. 
This operation is recursively extended to the elongation by a finite sequence of beads as: for any conformation $C$, $C \xrightarrow{R}_\lambda^* C$; and for a finite sequence of beads $w \in \Sigma^*$ and a bead $b \in \Sigma$, a conformation $C_1$ is elongated to a conformation $C_2$ by $wb$, written as $C_1 \xrightarrow{R}_{wb}^* C_2$, if there is a conformation $C'$ that satisfies $C_1 \xrightarrow{R}_w^* C'$ and $C' \xrightarrow{R}_b C_2$. 

An \textit{oritatami system} (OS) $\Xi = (\Sigma, R, \delta, \alpha, \sigma, w)$ is composed of
\begin{itemize}
\item a set $\Sigma$ of bead types, 
\item a rule set $R \subseteq \Sigma \times \Sigma$, 
\item a positive integer $\delta$ called the \textit{delay}, 
\item a positive integer $\alpha$ called the \textit{arity}, 
\item an initial $R$-valid conformation $\sigma \in C_{\le \alpha}(\Sigma)$ called the \textit{seed}, whose first bead is assumed to be at the origin $O$ without loss of generality, 
\item a (possibly infinite) \textit{transcript} $w \in \Sigma^* \cup \Sigma^\omega$, which is to be folded upon the seed by stabilizing beads of $w$ one at a time so as to minimize energy collaboratively with the succeeding $\delta{-}1$ nascent beads. 
\end{itemize}
The energy of a conformation $C = (P, w, H)$, denoted by $\Delta G(C)$, is defined to be ${-}|H|$; the more bonds a conformation has, the more stable it gets. 
The set $\mathcal{F}(\Xi)$ of conformations \textit{foldable} by the system $\Xi$ is recursively defined as: the seed $\sigma$ is in $\mathcal{F}(\Xi)$; and provided that an elongation $C_i$ of $\sigma$ by the prefix $w[1..i]$ be foldable (i.e., $C_0 = \sigma$), its further elongation $C_{i+1}$ by the next bead $w[i+1]$ is foldable if 
\begin{equation}\label{eq:OS_CF}
C_{i+1} \in \argmin_{
\substack{
C \in \mathcal{C}_{\le \alpha} s.t. \\
C_i \xrightarrow{R}_{w[i+1]}C \\
}
}
\min \Bigl\{ \Delta G(C') \Bigm|
C \xrightarrow{R}^*_{w[i+2...i+k]}C', k\le \delta, C' \in \mathcal{C}_{\le \alpha}
\Bigr\}.
\end{equation}
%
Then we say that the bead $w[i+1]$ and the bonds it forms are \textit{stabilized} according to $C_{i+1}$. 
Note that an arity-$\alpha$ oritatami system cannot fold any conformation of arity larger than $\alpha$. 
A conformation foldable by $\Xi$ is \textit{terminal} if none of its elongations is foldable by $\Xi$. 
The oritatami system $\Xi$ is \textit{deterministic} if for all $i \ge 0$, there exists at most one $C_{i+1}$ that satisfies \eqref{eq:OS_CF}. 
A deterministic oritatami system folds into a unique terminal conformation. 
An oritatami system with the empty rule set just folds into an arbitrary elongation of its seed nondeterministically. 
Thus, the rule set is reasonably assumed non-empty. 

In this paper, we considerably focus on the unary oritatami system. 
An oritatami system is \textit{unary} if it involves only one type of bead, say $a$, that is, $\Sigma = \{a\}$. 
Its rule set is $R = \{(a, a)\}$. 
Its transcript is a sequence of $a$-beads so that nothing can be hardcoded on it. 


\begin{proposition}\label{prop:check_validity}
	For any rule set $R$, arity $\alpha$ and conformation $C = (P,w,H)$ it is possible to check whether $C$ is $R$-valid and whether $C\in \mathcal{C}_{\leq \alpha}$ in time $\mathcal{O}(|H|\cdot|w|\cdot|R|)$.
\end{proposition}
\begin{proof}
	To check whether $C$ is $R$-valid:
	\begin{enumerate}
		\item FOR each $(i,j)\in H$:
		\item \hspace{1cm} IF $(w[i],w[j])\notin R$ THEN answer NO and HALT
		\item answer YES and HALT
	\end{enumerate}	
	Checking the condition in 2. can be done in $\mathcal{O}(|w|\cdot|R|)$ time for any reasonable representation of $w$ and $R$, hence the whole process takes $\mathcal{O}(|H|\cdot |w|\cdot|R|)$ time.	
	To check the arity constraint $C\in \mathcal{C}_{\leq \alpha}$: 
	\begin{enumerate}
		\item FOR each $i\in \{1,\dots,|w|\}$:
		\item \hspace{1cm} IF $\mathrm{degree}(i)=|\{j | (i,j)\in H \}|>\alpha$ THEN answer NO and HALT
		\item answer YES and HALT
	\end{enumerate}	
	Checking the condition in 2. can be done in $\mathcal{O}(|H|)$ time for any reasonable representation of $H$, hence the whole process takes $\mathcal{O}(|w|\cdot|H|)$ time.
\end{proof}

\begin{theorem}\label{thm:OS_to_2dTM}
	There is an algorithm that simulates any deterministic oritatami system $\Xi = (\Sigma, R, \delta, \alpha, \sigma, w)$ in time $2^{\mathcal{O}(\delta)}\cdot |R|\cdot|w|$. 
\end{theorem}
\begin{proof}
	Take any step in the computation, up to which some $i \ge 0$ first beads of $w$ have been stabilized, with the last bead at a point $p$. 
	The number of all possible elongations of the current conformation by the next $\delta$-beads is $(6 \times 5^{\delta-1}) \times ((2^4)^{\delta-1} \times 2^5) \in 2^{O(\delta)}$. 
	By Proposition~\ref{prop:check_validity}, we can check for each of these elongations whether its arity is at most $\alpha$ or not and whether it is $R$-valid or not in time $\mathcal{O}((2^4)^{\delta-1}\cdot2^5\cdot \delta\cdot|R|)=2^{\mathcal{O}(\delta)}\cdot|R|$.  Therefore, the total running time is $2^{\mathcal{O}(\delta)}\cdot |R|\cdot|w|$.
\end{proof}

\begin{corollary}\label{cor:DTIME3}
	For fixed $\delta$, the class of problems solvable by deterministic oritatami systems $(\Sigma, R, \delta, \alpha, \sigma, w)$ is included in $\mathrm{DTIME}(|w|^3)$.
\end{corollary}
\begin{proof}
	The claim follows from Theorem~\ref{thm:OS_to_2dTM} and the fact that $|R|$ is implicitly bounded by $|w|^2$.
\end{proof}

%\begin{corollary}\label{polytranscript}
%	Let $k$ be a non-negative number. Let $\Sigma$, $H$, $\delta$, $\alpha$ be fixed and the transcript length bounded polynomially by the seed length, i.e., $|w|\in O(|\sigma|^k)$. Then, the language of seeds $\sigma$ accepted by an OS $(\Sigma, R, \delta, \alpha, \sigma, w)$ is in $\mathrm{DTIME}(|\sigma|^{2k})$.
%\end{corollary}

%If the transcript length is polynomially bounded by the seed length, than the accepted language is in $\mathrm{P}$. 

Because of the time hierarchy theorems, we know that $\mathrm{P}\subsetneq \mathrm{EXP}$, so we can conclude that OS which cannot deterministically fold transcripts of length exponential in the length of the seed are not computationally universal.


\section{Case of arity $1$}\label{sect:arity1}


\input{arity1}


\section{Case of delay $1$}\label{sect:delay1}
\input{tt_intro}
\input{tt_theorem}


\subsection*{Acknowledgements}
We thank Yo-Sub Han for his valuable comments on the contents of this paper. 

\bibliographystyle{splncs03}
\bibliography{tamc2019}
  
\end{document}
