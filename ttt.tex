\documentclass[runningheads]{llncs}





\usepackage[dvipdfmx]{color}

\usepackage[dvipdfmx]{graphicx}
\usepackage{tikz}
\usepackage{calc}
\usetikzlibrary{automata}





\begin{document}

\title{On finiteness of structures produced deterministically by co-transcriptional folding}

\section{Infiniteness of delay-1, arity-2 unary deterministic oritatami system}

\begin{figure}
  \begin{center}
    \begin{tikzpicture}
      \draw[thick, rounded corners = 10pt]
      (-1,-1)--(7,-1)--(7,2)--(-1,2)-- cycle;

      \fill (0,0) circle[radius = 0.1];
      \fill (1.5,0) circle[radius = 0.1];
      \fill (3,0) circle[radius = 0.1];
      \fill (4.5,0) circle[radius = 0.1];
      \fill (6,0) circle[radius = 0.1];

      \draw[dashed] (0,0)--(1.5,0);
      \draw[dashed] (1.5,0)--(3,0);
      \draw[dashed] (3,0)--(4.5,0);
      \draw[dashed] (4.5,0)--(6,0);
      \draw[->] (0,0)--(60:1.3);
      \draw[->] (1.5,0)--++(60:1.3);
      \draw[->] (3,0)--++(60:1.3);
      \draw[->] (4.5,0)--++(60:1.3);
      
      \begin{scope}[shift=(60:1.5)]
        \fill (0,0) circle[radius = 0.1];
        \fill (1.5,0) circle[radius = 0.1];
        \fill (3,0) circle[radius = 0.1];
        \fill (4.5,0) circle[radius = 0.1];
        \draw[dashed] (0,0)--(1.5,0);
        \draw[dashed] (1.5,0)--(3,0);
        \draw[dashed] (3,0)--(4.5,0);
        \draw[->] (0,0)--(-60:1.3);
        \draw[->] (1.5,0)--++(-60:1.3);
        \draw[->] (3,0)--++(-60:1.3);
        \draw[->] (4.5,0)--++(-60:1.3);
      \end{scope}
      
    \end{tikzpicture}
    \caption{zig-zag conformation}
    \label{TTT_zigzag}
  \end{center}
\end{figure}

\subsection{Introduction}


In this section, we prove that unary oritatami system can form infinitely at delay 1 and arity 1 deterministically moreover the infinite terminal which its oritatami system can yield is only zig-zag conformations shown in Fig\ref{TTT_zigzag}. 


Let $\Xi$ be a deterministic oritatami system of delay 1 and arity 2. Assume its seed $\sigma$ consists of $n$ beads. Let us denote its transcript by $w = w_1 w_2 w_3 \cdots$ for some $w_1,w_2,w_3 \in \Sigma = \{e\}$. For $i \geq 0$ let $C_i$ be the unique elongation of $\sigma$ by $w[1..i]$ that is foldable by $\Xi$. Hence $C_0 = \sigma$.


Let us consider the stabilization of the $i$-th bead $a_i$ upon $C_{i-1}$. The bead cannot collaborate with any succeeding bead $w_{i+1},w_{i+2},\cdots$ at delay 1. There are just two ways to get stabilized at delay 1. One way is to be bound to another bead. The other way is through a $tunnel\ section$. A tunnel section consists of four beads that occupt four neighbors of a point(Fig.\ref{TTT_tunnel_intro}). Assume that four of the six neighbors of a point $p$ are occupied by beads $a_{j_1},a_{j_2},a_{j_3},a_{j_4}$ while the other two are not occupied. We call such beads as $p$ $inside\ of\ a\ tunnel$ and such beads as $p^\prime$ $entrance\ of\ a\ tunnel$ without a case that $p^\prime$ is inside of a tunnel. If the beads $a_{i-2}$ and $a_{i-1}$ are stabilized respectively at one of the two free neighbors and at $p$ one after another, then the next bead $a_i$ cannot help but be stabilized at the other free neighbor. In this way, $a_i$ can get stabilized without being bound.



If a bead is stabilized through a tunnel section, then it can provide two binging capabilities and create tunnel sections.



\begin{figure}
  \begin{center}
    \begin{tikzpicture}
      \fill (0:0) circle [radius=0.05];
      \fill (0:1.5) circle [radius=0.05];
      \fill (180:1.5) circle [radius=0.05];
      \node[above] at (0:1.5) { $p^\prime$ };
      \node[above] at (0:0) { $p$ };
      \node[above] at (180:1.5) { $p^\prime$ };
      
      \fill (60 : 1.5) circle [radius=0.1];
      \fill (-60 : 1.5) circle [radius=0.1];
      \fill (120 : 1.5) circle [radius=0.1];
      \fill (-120 : 1.5) circle [radius=0.1];
      \node[above] at (60 :1.5) { $a_{j_1}$ };
      \node[above] at (-60 :1.5) { $a_{j_2}$ };
      \node[above] at (120 :1.5) { $a_{j_3}$ };
      \node[above] at (-120 :1.5) { $a_{j_4}$ };
      
      \begin{scope}[shift=(0:5)]
        \fill (0:0) circle [radius=0.1];
        \fill (0:1.5) circle [radius=0.05];
        \fill (180:1.5) circle [radius=0.1];
        \node[above] at (180:1.5) { $a_{i-2}$ };
        \node[above] at (0:0) { $a_{i-1}$ };
        \draw[->] (180:1.4) -- (180:0.1);
        
        \fill (60 : 1.5) circle [radius=0.1];
        \fill (-60 : 1.5) circle [radius=0.1];
        \fill (120 : 1.5) circle [radius=0.1];
        \fill (-120 : 1.5) circle [radius=0.1];
        \node[above] at (60 :1.5) { $a_{j_1}$ };
        \node[above] at (-60 :1.5) { $a_{j_2}$ };
        \node[above] at (120 :1.5) { $a_{j_3}$ };
        \node[above] at (-120 :1.5) { $a_{j_4}$ };
      \end{scope}
      \begin{scope}[shift=(0:10)]
        \fill (0:0) circle [radius=0.1];
        \fill (0:1.5) circle [radius=0.1];
        \fill (180:1.5) circle [radius=0.1];
        \node[above] at (180:1.5) { $a_{i-2}$ };
        \node[above] at (0:0) { $a_{i-1}$ };
        \node[above] at (0:1.5) { $a_i$ };
        \draw[->] (180:1.4) -- (180:0.1);
        \draw[->] (0:0.1) -- (0:1.4);
        
        \fill (60 : 1.5) circle [radius=0.1];
        \fill (-60 : 1.5) circle [radius=0.1];
        \fill (120 : 1.5) circle [radius=0.1];
        \fill (-120 : 1.5) circle [radius=0.1];
        \node[above] at (60 :1.5) { $a_{j_1}$ };
        \node[above] at (-60 :1.5) { $a_{j_2}$ };
        \node[above] at (120 :1.5) { $a_{j_3}$ };
        \node[above] at (-120 :1.5) { $a_{j_4}$ };
      \end{scope}
    \end{tikzpicture} 
    \caption{Through a tunnel section}
    \label{TTT_tunnel_intro}
  \end{center}
\end{figure}




\begin{theorem}[Tunnel Troll Theorem]
  Let $\Xi$ be an unary oritatami system of delay 1 and arity 2. If a bead is stabilized through a tunnel section, then it consume some binging capabilities.
\end{theorem}

\subsection{Proof of Tunnel Troll Theorem}
Assume $\Xi$ is deterministic. Let us represent its transcript $w$ as $w = w_1 w_2 w_3 \cdots$ for beads $w_1 , w_2 , w_3 , \cdots \in \Sigma = \{e\}$. Each of these beads is stabilized either by being bound or through a tunnel section (or by both). How they are stabilized can be described by a binary sequence $S$ of $b$'s (bound) and $t$'s (tunnel section); priority is given to $t$, that is, $S[i] = t$ if the $i$-th bead $w_i$ is stabilized not only by being bound but also through a tunnel section. 
On the other hand, each of beads are bound either inside of tunnel or outside (Fig. \ref{TTT_position1}). If a bead is stabilized at inside of tunnel, then its successor is already decided the position either inside of a tunnel or outside. Moreover, If a bead is stabilized at outside of a tunnel, then its position is an entrance of a tunnel or otherwise.


Tunnel sections have three possible shape with considering symmetry such as acute turn, straight and obtuse turn (Figure \ref{TTT_tunnel}). Let us focus entrances of a tunnel such as $p^\prime$, then Entrances have two possible shape (Figure \ref{TTT_enterpoint}).


Let us consider tunnel sections only tunnel A and B. See Fig. \ref{TTT_position2}. From appendix (Entrance of Tunnel A, B and Exit of Tunnel), we add maximum number which each transitions provide binding capabilities for each edge where $a$ is number of consuming binding capabilities when the bead is stabilized at position of $successer\ in\ outside$.


Next, we consider on tunnel C section. If $w[i]$ is stabilized by tunnel C and $S[i+1]$ is $t$, then $w[i+1]$ is stabilized by tunnel A or B because if $w[i+1]$ is stabilized by tunnel C, then $C_{i+1}$ is a terminal. Hence, tunnel C section is devided cases sush as Figure \ref{TTT_tunnelC_graph}. Cases of $S[i...] = bt^l (l \geq 2)$ are already considered (Upper). According to appendix (Tunnel C), cases of $S[i..i+2] = btb$ also consume some binding capabilities (Lower).


Thus, if a bead is stabilized through a tunnel section, then it consume some binging capabilities.



\begin{figure}
  \begin{center}
    \begin{tabular}{ccc}
      
      \begin{minipage}{0.3\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(4,0)--(4,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.05];
            \node[above] at (180:1.5) {$p^\prime$};
            \node[above] at (0:1.5) {$p^\prime$};

            \foreach \theta in {0,180}{
              \fill[transform canvas={shift=(\theta:1.5)}](0,0) circle [radius=0.05];
            }
            
            \foreach \theta in {60,-60,120,-120}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }
          \end{scope}

          \node at (2,-0.5) {Tunnel A};
        \end{tikzpicture}
      \end{minipage}

      \begin{minipage}{0.3\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(4,0)--(4,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.05];
            \node[above] at (180:1.5) {$p^\prime$};
            \node[above] at (-60:1.5) {$p^\prime$};

            \foreach \theta in {-60,180}{
              \fill[transform canvas={shift=(\theta:1.5)}](0,0) circle [radius=0.05];
            }
            
            \foreach \theta in {0,60,120,-120}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }
          \end{scope}

          \node at (2,-0.5) {Tunnel B};
        \end{tikzpicture}
      \end{minipage}

      \begin{minipage}{0.3\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(4,0)--(4,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.05];
            \node[above] at (180:1.5) {$p^\prime$};
            \node[above] at (-1200:1.5) {$p^\prime$};

            \foreach \theta in {-120,180}{
              \fill[transform canvas={shift=(\theta:1.5)}](0,0) circle [radius=0.05];
            }
            
            \foreach \theta in {0,60,-60,120}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }
          \end{scope}

          \node at (2,-0.5) {Tunnel C};
        \end{tikzpicture}
      \end{minipage}
      
    \end{tabular}
    \caption{All possible tunnel sections}
    \label{TTT_tunnel}
  \end{center}
\end{figure}

\begin{figure}[h]
  \begin{center}
    \begin{tabular}{cc}
      
      \begin{minipage}{0.45\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(2.5,0)--(2.5,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.1];
            \node[above] at (180:1.5) {$p^\prime$};
            
            \fill[transform canvas={shift=(180:1.5)}](0,0) circle [radius=0.1];
            
            
            \foreach \theta in {120,-120}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }

            \draw[->] (-1.4,0) -- (-0.1,0);
          \end{scope}

          \node at (1.25,-0.5) {Tunnel A,B};
        \end{tikzpicture}
      \end{minipage}

      \begin{minipage}{0.45\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(2.5,0)--(2.5,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.1];
            \node[above] at (180:1.5) {$p^\prime$};

            \draw[transform canvas={shift=(-120:1.5)}](0,0) circle [radius=0.1];
            \fill[transform canvas={shift=(180:1.5)}](0,0) circle [radius=0.1];
            
            
            \foreach \theta in {120}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }

            \draw[->] (-1.4,0) -- (-0.1,0);
          \end{scope}

          \node at (1.25,-0.5) {Tunnel C};
        \end{tikzpicture}
      \end{minipage}

    \end{tabular}
    \caption{Entrance of a tunnel}
    \label{TTT_enterpoint}
  \end{center}
\end{figure}



\begin{figure}
  \begin{center}
    \begin{tikzpicture}
      \draw[thick]
      (1.3,1)--(0,1)--(0,5)--(5,5)--(5,1)--(3.7,1);
      \node at(2.5,1) {Outside};
      \node at (2.5,4) [rectangle, draw,rounded corners] (enter) {Entrance of a tunnel};
      \node at(2.5,2) [rectangle, draw, rounded corners] (outside) {Otherwise};

      
      
      \draw[thick]
      (9.3,1)--(8,1)--(8,5)--(13,5)--(13,1)--(11.7,1);
      \node at(10.5,1) {Inside of a tunnel};
      \node at(10.5,4) [rectangle, draw, rounded corners] (next-tunnel) {Successor in inside};
      \node at(10.5,2) [rectangle, draw, rounded corners] (next-outside) {Successor in outside};

      \draw[->]
      (outside) edge [bend left] node[left] {$b$} (enter)
                edge [loop left] node[left] {$b$} (outside)
      (enter)   edge [bend left] node[above] {$b$} (next-tunnel)
                edge [bend left] node[above] {$b$} (next-outside)
                edge [bend left] node[right] {$b$}  (outside)
      (next-tunnel) edge         node[right] {$t$} (next-outside)
                edge [loop right]node[below] {$t$}    (next-tunnel)
      (next-outside) edge[bend left] node[above] {$t$}  (outside)
                edge [bend left]     node[above] {$t$}(enter)
      ;
      
    \end{tikzpicture}
    \caption{Cases on position of a bead}
    \label{TTT_position1}
  \end{center}
\end{figure}

\begin{figure}
  \begin{center}
    \begin{tikzpicture}
      \draw[thick]
      (1.3,1)--(0,1)--(0,5)--(5,5)--(5,1)--(3.7,1);
      \node at(2.5,1) {Outside};
      \node at (2.5,4) [rectangle, draw,rounded corners] (enter) {Entrance of a tunnel};
      \node at(2.5,2) [rectangle, draw, rounded corners] (outside) {Otherwise};

      
      
      \draw[thick]
      (9.3,1)--(8,1)--(8,5)--(13,5)--(13,1)--(11.7,1);
      \node at(10.5,1) {Inside of a tunnel};
      \node at(10.5,4) [rectangle, draw, rounded corners] (next-tunnel) {Successer in inside};
      \node at(10.5,2) [rectangle, draw, rounded corners] (next-outside) {Successer in outside};

      \draw[->]
      (outside) edge [bend left] node[left] {$-1$} (enter)
                edge [loop left] node[left] {$\pm 0$} (outside)
      (enter)   edge [bend left] node[above] {$-1$} (next-tunnel)
                edge [bend left] node[above] {$-a$} (next-outside)
                edge [bend left] node[right] {$\pm 0$}  (outside)
      (next-tunnel) edge         node[right] {$-a$} (next-outside)
                edge [loop right]node[below] {$\pm 0$}    (next-tunnel)
      (next-outside) edge[bend left] node[above] {$+a$}  (outside)
                edge [bend left]     node[above] {$+(a-1)$}(enter)
      ;
      
    \end{tikzpicture}
    \caption{Tunnel A,Bにおけるbondの増加量}
    \label{TTT_position2}
  \end{center}
\end{figure}

\begin{figure}[h]
  \begin{center}
    \begin{tikzpicture}
      \node at (0,4)   [rectangle, draw,rounded corners] (outside1) {Otherwise};
      \node at (4.5,4) [rectangle, draw,rounded corners] (enter1)   {Entrance of a tunnel};
      \node at (8,4)   [rectangle, draw, rounded corners] (inside1) {Inside of a tunnel C};
      \node at (11,4)  [rectangle, draw, rounded corners] (exit1)   {Inside of a tunnel A or B};
      \draw[->] (outside1)--(enter1);
      \draw[->] (enter1)  --(inside1);
      \draw[->] (inside1) --(exit1);
      
      
      \node at (0,3)   [rectangle, draw,rounded corners] (outside2) {Inside of a tunnel};
      \node at (4.5,3) [rectangle, draw,rounded corners] (enter2)   {Entrance of a tunnel};
      \node at (8,3)   [rectangle, draw, rounded corners] (inside2) {Inside of a tunnel C};
      \node at (11,3)  [rectangle, draw, rounded corners] (exit2)   {Inside of a tunnel A or B};     
      \draw[->] (outside2)--(enter2);
      \draw[->] (enter2)  --(inside2);
      \draw[->] (inside2) --(exit2);

      \node at (0,1)   [rectangle, draw,rounded corners] (outside3) {トンネルから離れている};
      \node at (4.5,1) [rectangle, draw,rounded corners] (enter3)   {トンネルの入り口};
      \node at (8,1)   [rectangle, draw, rounded corners] (inside3) {トンネルC};
      \node at (11,1)  [rectangle, draw, rounded corners] (exit3)   {トンネルの外};     
      \draw[->] (outside3)--(enter3);
      \draw[->] (enter3)  --(inside3);
      \draw[->] (inside3) --(exit3);

      \node at (0,0)   [rectangle, draw,rounded corners] (outside4) {トンネルの中};
      \node at (4.5,0) [rectangle, draw,rounded corners] (enter4)   {トンネルの入り口};
      \node at (8,0)   [rectangle, draw, rounded corners] (inside4) {トンネルC};
      \node at (11,0)  [rectangle, draw, rounded corners] (exit4)   {トンネルの外};     
      \draw[->] (outside4)--(enter4);
      \draw[->] (enter4)  --(inside4);
      \draw[->] (inside4) --(exit4);
    \end{tikzpicture}
    \caption{Tunnel Cの場合分け}
    \label{TTT_tunnelC_graph}
  \end{center}
\end{figure}


\subsection{Appendix of Tunnel Troll Theorem}
\subsubsection{Entrance of TunnelA,B}

Fig.\ref{TTT_tunnel_direction} exhibits all the three kinds of entrance of tunnel A, B.
Any cases in $\delta = 1, \alpha = 2$ consume some binding capabilities into the follows.


\begin{itemize}
\item{Case of $t_0$}\\
  Let us consider points of $c,d$ either occupied or not. A point $c$ or $d$ is free because if both of them are occupied, $p^\prime$ is inside of tunnel. If $c$ is free, then $p^\prime$ has to be bound to a bead except $A$ due to deterministically stabilize. In this situation, at least three neighbors of A are free that is at most three neighbors of A are occupied. A leave at least one binging capability because beads of beighbors are predecessor and successor in addition A is able to consume itself binging capabilities only one-time. Hence, $p^\prime$ must be bound to A. Thus, a case of $t_0$ consumes some binding capabilities.

\item{Case of $t_{\pm 60}$}\\
  In this case, a point $c$ or $d$ is free, too. If $c$ is free, $p^\prime$ has to be bound to A or B. If $c$ is occupied, then $d$ is free. This time, B has some binding capabilitie so $p^\prime$ has to be bound to B.
  

  In this situation, $p^\prime$ is able to supply a binding capability. if this capability is active, $p^\prime$ bind a bead into $c$ or $d$. However, B and P are exist in back bone. According to Jordan curve theorem, any successors of $p^\prime$ cannot reach a point $c$ or $d$ so this capability is inactive. Thus, a case of $t_{\pm 60}$ consumes some binding capabilities.

\item{Case of $t_{\pm 120}$}\\
  Binding capabilities that $p^\prime$ supply are inactive according to Jordan curve theorem on A and P. Moreover, $p^\prime$ has to be bound to one of $c$, $d$,$e$ in order to deterministically stabilize.
Thus, a case of $t_{\pm 120}$ consumes some binging capabilities.
  
\end{itemize}

\begin{figure}[h]
  \begin{center}
    \begin{tabular}{ccc}
      
      \begin{minipage}{0.3\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(4,0)--(4,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.1];
            \node[above] at (0,0) {$p^\prime$};

            \foreach \theta in {0}{
              \draw[transform canvas={shift=(\theta:1.5)}](0,0) circle [radius=0.1];
            }
            
            \foreach \theta in {60,-60,180}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }

            \foreach \theta in {120,-120}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1) rectangle (0.1,0.1);
            }

            \draw[->] (180:1.4)--(180:0.1);
            \draw[->] (0:0.1)--(0:1.4);

            \node[transform canvas={shift=(60:1.5)},right] {A};
            \node[transform canvas={shift=(-60:1.5)},right] {B};

            \node[transform canvas={shift=(120:1.5)},left] {c};
            \node[transform canvas={shift=(-120:1.5)},left] {d};
          \end{scope}

          \node at (2,-0.5) {$t_0$};
        \end{tikzpicture}
      \end{minipage}

      \begin{minipage}{0.3\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(4,0)--(4,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.1];
            \node[below] at (0,0) {$p^\prime$};

            \foreach \theta in {0}{
              \draw[transform canvas={shift=(\theta:1.5)}](0,0) circle [radius=0.1];
            }
            
            \foreach \theta in {60,-60,120}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }

            \foreach \theta in {180,-120}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1) rectangle (0.1,0.1);
            }
            
            \draw[->] (120:1.4)--(120:0.1);
            \draw[->] (0:0.1)--(0:1.4);

            \node[transform canvas={shift=(60:1.5)},right] {A};
            \node[transform canvas={shift=(-60:1.5)},right] {B};
            \node[transform canvas={shift=(120:1.5)},left] {P};

            \node[transform canvas={shift=(180:1.5)},left] {c};
            \node[transform canvas={shift=(-120:1.5)},left] {d};
          \end{scope}

          \node at (2,-0.5) {$t_{\pm 60}$};
        \end{tikzpicture}
      \end{minipage}

      \begin{minipage}{0.3\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(4,0)--(4,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.1];
            \node[above] at (0,0) {$p^\prime$};

            \foreach \theta in {0}{
              \draw[transform canvas={shift=(\theta:1.5)}](0,0) circle [radius=0.1];
            }
            
            \foreach \theta in {60,-60}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }

            \foreach \theta in {180,-120,120}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1) rectangle (0.1,0.1);
            }
            
            \draw[->] (60:1.4)--(60:0.1);
            \draw[->] (0:0.1)--(0:1.4);

            \node[transform canvas={shift=(-60:1.5)},right] {A};
            \node[transform canvas={shift=(60:1.5)},right] {P};

            \node[transform canvas={shift=(120:1.5)},left] {c};
            \node[transform canvas={shift=(180:1.5)},left] {d};
            \node[transform canvas={shift=(-120:1.5)},left] {e};
            \node[transform canvas={shift=(0:1.5)},below] {n};
          \end{scope}

          \node at (2,-0.5) {$t_{\pm 120}$};
        \end{tikzpicture}
      \end{minipage}
      
    \end{tabular}
    \caption{Direction into a entrance}
    \label{TTT_tunnel_direction}
  \end{center}
\end{figure}


\subsubsection{Exit of Tunnel}


Fig.\ref{TTT_tunnel_exit} exhibits all the two kings of exit of tunnel. 
At least one of point $c$ or $d$ is free because if both of them are occupied, $p^\prime$ is inside of tunnel.

\paragraph{$\delta = 1, \alpha = 2$}
 Any cases of $\delta = 1, \alpha = 2$ supply at most $a$ binding capabilities into follows where $a$ is number of predecessor of $p^\prime$ consumes binging capabilities.

\begin{itemize}
\item{Case of $c$ and $d$ are free}\\
  This case can be regarded same situation as entrance. See Fig.\ref{TTT_tunnel_exit} (Left). Predecessor P has to be bound A and B because each of A and B leave binding capabilities. Hence, at least $a=2$. This time, $\alpha = 2$ that is this case supply at most only $a$ binding capabilities.
  
\item{Case of $c$ is occupied}\\
  See Fig.\ref{TTT_tunnel_exit} (Right). If $c$ is pccupied, then $d$ is free so that P has to be bound B. Hence, at least $a=1$. This case can supply two binding capabilities but $p^\prime$ can bind to only one of $e$ or $d$ because $e$ or $d$ will be occupied a successor of $p^\prime$. Therefore, this case supply at most only $a=1$ active binding capabiliry.
  
\end{itemize}

\paragraph{$\delta = 1, \alpha \geq 3$}
Any cases of $\delta = 1, \alpha \geq 3$ consume some binding capabilities into follows.

\begin{itemize}
\item{Case of $c$ and $d$ are free}\\
  In $\alpha \geq 3$, if three neighbors of a bead leave, then it can supply two binding capabilities. Therefore Predecessor P has to be bound A and B, and $p^\prime$, too. In this case, at least consumes four bindings and supplies at most two bindings. Thus, it consumes some binding capabilities, totally.
  
\item{Case of $c$ is occupied}\\
  In this case, B leave at least two bindings and A, $c$ also leave at least one binding. Therefore P has to be bound A and B, and $p^\prime$ also has to be bound B and $c$. In this case, at least consumes four bindings and supplies at most one binding. Thus, it consumes some binding capabiliries, totally.
\end{itemize}


\begin{figure}[h]
  \begin{center}
    \begin{tabular}{cc}
      
      \begin{minipage}{0.48\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(4,0)--(4,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.1];
            \node[above] at (0,0) {$p^\prime$};

            
            \foreach \theta in {120,-120,180}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }

            \foreach \theta in {0,60,-60}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1) rectangle (0.1,0.1);
            }

            \draw[->] (180:1.4)--(180:0.1);

            \node[transform canvas={shift=(120:1.5)},right] {A};
            \node[transform canvas={shift=(-120:1.5)},right] {B};
            \node[transform canvas={shift=(180:1.5)},left] {P};

            \node[transform canvas={shift=(60:1.5)},left] {c};
            \node[transform canvas={shift=(-60:1.5)},left] {d};
          \end{scope}

          \node at (2,-0.5) {Point $c$ and $d$ are free};
        \end{tikzpicture}
      \end{minipage}

      \begin{minipage}{0.48\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (0,0)--(4,0)--(4,4)--(0,4)-- cycle;

          \begin{scope}[xshift=2cm, yshift=2cm]
            \fill(0,0) circle [radius=0.1];
            \node[above] at (0,0) {$p^\prime$};
            
            \foreach \theta in {120,-120,180,60}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }

            \foreach \theta in {0,-60}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1) rectangle (0.1,0.1);
            }

            \draw[->] (180:1.4)--(180:0.1);

            \node[transform canvas={shift=(120:1.5)},right] {A};
            \node[transform canvas={shift=(-120:1.5)},right] {B};
            \node[transform canvas={shift=(180:1.5)},left] {P};

            \node[transform canvas={shift=(-60:1.5)},right] {d};
            \node[transform canvas={shift=(60:1.5)},right] {c};
            \node[transform canvas={shift=(0:1.5)},right] {e};
          \end{scope}
          
          \node at (2,-0.5) {Point $c$ is occupied};
        \end{tikzpicture}
      \end{minipage}

      
      
    \end{tabular}
    \caption{Exit of Tunnel}
    \label{TTT_tunnel_exit}
  \end{center}
\end{figure}


\subsubsection{Tunnel C}

Tunnel Cの入口に固定されるbeadについて、そのbeadがTunnelを消費して固定されたか、
そうでないかによって場合分けをする。なお、Tunnel Cの出口はTunnelA,Bの中でないとする。

\subsubsection{Tunnel Cの入口のbeadがTunnelを消費して固定された場合}
Tunnel Cの構造を維持したまま入口にTunnel消費によるbeadを固定するパターンはfig.\ref{TTT_tunnelC_enter_usingTunnel}の２通りがある。

\begin{itemize}
\item{Pattern1}\\
  頂点$t_1$が転写される前では、$t_3$がトンネルの外であることから頂点Aの周囲3点は空いてる。よって頂点Aのbeadは1つ以上bondを持つため、頂点Aと$t_1$はbondを結ぶ。また、頂点$t_2$が決定的に固定されるためには頂点B,C,Dとの間とbondを結ぶ必要がある。一方で、頂点$t_1,t_2$は、たとえbondを増やしたとしても周囲6点が埋まっているため、それを使うことができない。つまり$t_2$が固定された時点でbondは$2$減少している。今、$t_3$が固定された時を考えると、このbeadはbondを最大で2つ増やす可能性がある。しかし今$t_3$の周囲で空いているのは頂点e,fで、このうち一方はback boneのために使われるため、$t_3$の増やしたbondは1つのみが有効なbondとなる。よって全体でbondの総数を1以上減少させる。

\item{Pattern2}\\
  頂点$t_1$が固定される時そのbeadが幾つ周囲のbondを消費するかで場合分けできる。
  \begin{itemize}
  \item[-]{$t_1$がbondを消費しない場合}\\
    頂点$t_2$が決定的に固定される時、bondを1以上消費しかつ有効なbondを増やさない。頂点$t_3$が固定される時、頂点$t_1$はbondを持っているため、$t_3$,$t_1$の間でbondを結ぶ。よって$t_3$の固定で増加するbondの数は0以下。一方で、この時$t_1$はまだ有効なbondを一つ持っている。もし頂点eが埋まっているならこのbondは有効でなくなりbondの総数は減少する。そこで仮に頂点eが空いている場合を考える。今$t_3$の次に固定されるbeadを$t_4$とする。もし$t_4$が頂点eに固定されたなら、$t_1$のbondを消費しかつ$t_4$はbondを1つ消費し1つ増やす。よって$t_1$から$t_4$の固定においてbondの総数は減少する。次に$t_4$が頂点f,gのどちらかに固定される場合を考える。頂点eは空いているため、決定的に固定するに$t_4$は2つのbondを消費する必要がある。よって$t_1$が増やしたbondを加味してもbond$t_1$から$t_4$の固定でbondの総数を減らすことになる。よっていずれのケースを考えてもbondの総数は減少する。

  \item[-]{$t_1$がbondを1つ消費する場合}\\
    $t_2$は同様にしてbondの総数を1つ減少させ、$t_3$も増加させるbondの数は0以下。この時$t_1$はbondを増やさない。よってbondの総数は2以上減少する。
  \item[-]{$t_1$がbondを2つ消費する場合}\\
    $t_2$はbondを1つ以上減少させ、$t_3$はbondを2つ増加させる。よってbondの総数は減少する。
  \end{itemize}
\end{itemize}

\begin{figure}[h]
  \begin{center}
    \begin{tabular}{cc}
      
      \begin{minipage}{0.48\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (-2,2)--(5,2)--(5,-3)--(-2,-3)-- cycle;

          \draw[transform canvas={shift=(0:0)}](-0.1,-0.1)--(0.1,0.1);
          \draw[transform canvas={shift=(0:0)}](0.1,-0.1)--(-0.1,0.1);
          
          \foreach \theta in {60,-60,120,-120,180}{
            \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
            \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
          }

          \fill(0:1.5) circle [radius=0.1];
          \draw[->] (0:0.1)--(0:1.4);

          \node[left] at (-60:1.5) {A};

          \begin{scope}[shift=(0:3)]
            \fill(0,0) circle [radius=0.1];

            
            \foreach \theta in {120,60,-60}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }

            \draw[->] (180:1.4)--(180:0.1);
            \draw[->] (-120:0.1)--(-120:1.4);

            \node[below] at (180:1.5) {$t_1$};
            \node[right] at (0:0) {$t_2$};
            \node[right] at (-120:1.5) {$t_3$};

            \node[left] at (120:1.5) {B};
            \node[left] at (60:1.5) {C};
            \node[left] at (0:1.5) {D};

            \begin{scope}[shift=(-120:1.5)]
              \draw(0,0) circle [radius=0.1];
              \foreach \theta in {-120,-60}{
                \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1) rectangle (0.1,0.1);
              }

              \node[right] at (-120:1.5) {e};
              \node[right] at (-60:1.5) {f};
            \end{scope}
            
          \end{scope}

          \node at (1.5,-3.5) {Pattern 1};
        \end{tikzpicture}
      \end{minipage}

      \begin{minipage}{0.48\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (-2,2)--(4.5,2)--(4.5,-4.5)--(-2,-4.5)-- cycle;

          \draw[transform canvas={shift=(0:0)}](-0.1,-0.1)--(0.1,0.1);
          \draw[transform canvas={shift=(0:0)}](0.1,-0.1)--(-0.1,0.1);
          
          \foreach \theta in {60,0,120,-120,180}{
            \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
            \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
          }

          \draw[->] (-60:0.1)--(-60:1.4);


          \begin{scope}[shift=(-60:1.5),shift=(0:1.5)]
            \fill(0,0) circle [radius=0.1];
            \fill(180:1.5) circle [radius=0.1];

            
            \foreach \theta in {120,60,0,-60}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
              \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
            }

            \draw[->] (180:1.4)--(180:0.1);
            \draw[->] (-120:0.1)--(-120:1.4);

            \node[below] at (180:1.5) {$t_1$};
            \node[right] at (0:0) {$t_2$};
            \node[right] at (-120:1.5) {$t_3$};

            \node[left] at (120:1.5) {A};
            \node[left] at (60:1.5) {B};
            \node[left] at (0:1.5) {C};

            \begin{scope}[shift=(-120:1.5)]
              \draw(0,0) circle [radius=0.1];
              \foreach \theta in {180,-120,-60}{
                \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1) rectangle (0.1,0.1);
              }

              \node[right] at (180:1.5) {e};
              \node[right] at (-120:1.5) {f};
              \node[right] at (-60:1.5) {g};
            \end{scope}
            
          \end{scope}

          \node at (1.25,-5) {Pattern 2};
        \end{tikzpicture}
      \end{minipage}

      
      
    \end{tabular}
    \caption{Tunnelを消費して入口に固定されたbead}
    \label{TTT_tunnelC_enter_usingTunnel}
  \end{center}
\end{figure}


\subsubsection{TunnelCの入口のbeadがTunnelを使わずに固定された場合}
TunnelCの入口のbeadがTunnelを使わずに固定される時、そのbeadは既存のbondを使うことによって固定される。fig.\ref{TTT_tunnelC_enter_usingBond}において$t_1$がいくつのbondを消費したかで場合分けを考える。

\begin{itemize}
\item{$t_1$が1つのbondを消費する場合}\\
  この時$t_1$は1つの有効なbondを生み出す。$t_2$は頂点A,B,Cの少なくとも一つとbondを結ぶ必要があり、かつ有効なbondを増やさない。$t_3$について考えると、$t_1$がbondを残していることから$t_3$と$t_1$はbondで結ばれる。故にbondの総数は1以上減少する。

\item{$t_1$が2つのbondを消費する場合}\\
  この時$t_1$はbondを生み出さない。$t_2$については先程と同様bondの総数を1減らす。今、$t_3$はどのbeadともbondを結ばない可能性があるため、bondの総数を最大で2増加させる。故にbondの総数は1以上減少する。
\end{itemize}



\begin{figure}[h]
  \begin{center}
    \begin{tabular}{cc}
      
      \begin{minipage}{0.48\hsize}
        \begin{tikzpicture}
          \draw[thick, rounded corners = 10pt]
          (-3,2)--(2.5,2)--(2.5,-3)--(-3,-3)-- cycle;
          
          \foreach \theta in {60,-60,120,0}{
            \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1)--(0.1,0.1);
            \draw[transform canvas={shift=(\theta:1.5)}](0.1,-0.1)--(-0.1,0.1);
          }

          \fill(180:1.5) circle [radius=0.1];
          \fill(0:0) circle [radius=0.1];

          \draw[transform canvas={shift=(180:1.5)}] (105:1.4) edge[bend right] (105:0.1);
          \draw[->] (180:1.4) -- (180:0.1);
          \draw[->] (-120:0.1) -- (-120:1.4);

          \node[below] at (180:1.5) {$t_1$};
          \node[right] at (0:0) {$t_2$};
          \node[left] at (-120:1.5) {$t_3$};

          \node[right] at (120:1.5) {A};
          \node[right] at (60:1.5) {B};
          \node[right] at (0:1.5) {C};

          \begin{scope}[shift=(-120:1.5)]
            \draw(0,0) circle [radius=0.1];
            \foreach \theta in {-120,-60,180}{
              \draw[transform canvas={shift=(\theta:1.5)}](-0.1,-0.1) rectangle (0.1,0.1);
            }
            
          \end{scope}
          
          \node at (-0.25,-3.5) {Pattern 1};
        \end{tikzpicture}
      \end{minipage}

      
      
    \end{tabular}
    \caption{Tunnelを消費せずに入口に固定されたbead}
    \label{TTT_tunnelC_enter_usingBond}
  \end{center}
\end{figure}


By Tunnel Troll Theorem, any tunnel sections which represented in $bbt^+$ or $bt^+bt^+$ consume binding capabilities.

\end{document}
